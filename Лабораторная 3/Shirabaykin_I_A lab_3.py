# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1OmNRzXAh7B7pc83VWwL2aOgbobT_575N

–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫:
"""

from tensorflow.keras.datasets import fashion_mnist
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.utils import to_categorical

"""–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ:"""

(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()

"""–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ—é—Ç —Ä–∞–∑–º–µ—Ä 28x28 –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —è–≤–ª—è–µ—Ç—Å—è
–¥–≤—É—Ö–º–µ—Ä–Ω—ã–º–∏. –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—à –ø–µ—Ä—Å–µ–ø—Ç—Ä–æ–Ω —Å–ø–æ—Å–æ–±–µ–Ω —Å—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ
–æ–¥–Ω–æ–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∏—Ö
"""

x_train = x_train.reshape(x_train.shape[0], -1) / 255.0
x_test = x_test.reshape(x_test.shape[0], -1) / 255.0
y_train = to_categorical(y_train)
y_test = to_categorical(y_test)

"""–û–ø–∏—à–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ç–∏:"""

model = Sequential()
model.add(Dense(10, input_dim=784, activation='relu'))
model.add(Dense(10, activation='softmax'))
model.compile(loss='categorical_crossentropy', optimizer='adam',
metrics=['accuracy'])

"""–ù–∞—á–Ω–µ–º –æ–±—É—á–µ–Ω–∏–µ:

"""

model.fit(x_train, y_train, epochs=10, validation_split=0.1)

"""–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

"""

test_acc = model.evaluate(x_test, y_test)
print(test_acc)

"""–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—é—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è:

Loss (—Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å): 0.4316307008266449
Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å): 0.8483 –∏–ª–∏ 84.83%
–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 84.83%. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–∫–æ–ª–æ 85% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞. –î–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–¥–µ–∂–¥—ã, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç 10 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤, —Ç–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–∏–º, –æ—Å–æ–±–µ–Ω–Ω–æ —É—á–∏—Ç—ã–≤–∞—è –ø—Ä–æ—Å—Ç–æ—Ç—É –º–æ–¥–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –¥–≤–∞ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ—è).

**–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Loss)**
–ó–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–≤–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 0.43. –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–π –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–∏ –∏–∑–º–µ—Ä—è–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏ –∏ –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤. –ú–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–º. –ó–Ω–∞—á–µ–Ω–∏–µ 0.43 –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Ç–æ, —á—Ç–æ –º–æ–¥–µ–ª—å –≤—Å—ë –µ—â—ë –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ –≤ —Ç–æ—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ –≤ —Ü–µ–ª–æ–º –æ–Ω–∞ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π.

–û–ø–∏—à–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ç–∏ 2:
"""

model2 = Sequential()
model2.add(Dense( 50, input_dim=784, activation='relu'))
model2.add(Dense(10, activation='softmax'))
model2.compile(loss='categorical_crossentropy', optimizer='adam',
metrics=['accuracy'])
model2.fit(x_train, y_train, epochs=10, validation_split=0.1)

test_acc = model2.evaluate(x_test, y_test)
print(test_acc)

"""–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏ –≤—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞—é—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è:

Loss (—Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å): 0.3635515570640564
Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å): 0.8715 –∏–ª–∏ 87.15%
–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 87.15%. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–∫–æ–ª–æ 87% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é, —ç—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ. –¢–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ—á–Ω–æ—Å—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è –≤—ã—Å–æ–∫–∏–º –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–¥–µ–∂–¥—ã —Å 10 –∫–ª–∞—Å—Å–∞–º–∏.

**–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Loss)**
–ó–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–≤–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 0.36. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∏–∂–µ, —á–µ–º —É –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª–∏, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–º. –ú–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –±–æ–ª–µ–µ –±–ª–∏–∑–∫–∏ –∫ –∏—Å—Ç–∏–Ω–Ω—ã–º –º–µ—Ç–∫–∞–º –∫–ª–∞—Å—Å–æ–≤.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é**
–í—Ç–æ—Ä–∞—è –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é –∫–∞–∫ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ –ø–µ—Ä–≤–æ–º –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–æ–º —Å–ª–æ–µ —Å 10 –¥–æ 50 –ø–æ–∑–≤–æ–ª–∏–ª–æ –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

–û–ø–∏—à–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ç–∏ 3:
"""

model3 = Sequential()
model3.add(Dense(50, input_dim=784, activation='relu'))
model3.add(Dense(50, activation='relu'))
model3.add(Dense(10, activation='softmax'))
model3.compile(loss='categorical_crossentropy', optimizer='adam',
metrics=['accuracy'])
model3.fit(x_train, y_train, epochs=10, validation_split=0.1)

"""–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö."""

test_acc = model3.evaluate(x_test, y_test)
print(test_acc)

"""–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏ —Ç—Ä–µ—Ç—å–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞—é—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è:

Loss (—Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å): 0.3670
Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å): 0.8749 –∏–ª–∏ 87.49%
–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 87.49%. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–∫–æ–ª–æ 87.5% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é —ç—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ, —á–µ–º —É –≤—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª–∏.

**–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Loss)**
–ó–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–≤–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 0.3670. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ, —á–µ–º —É –≤—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª–∏, –Ω–æ –≤—Å—ë –µ—â—ë —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ö–æ—Ä–æ—à–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–º.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏**
–¢—Ä–µ—Ç—å—è –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é –∏ –Ω–µ–±–æ–ª—å—à–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –≤—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª—å—é. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ª–æ—è –ø–æ–∑–≤–æ–ª–∏–ª–æ –º–æ–¥–µ–ª–∏ –Ω–µ–º–Ω–æ–≥–æ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º
–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å–≤–µ—Ä—Ç–æ—á–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å.
"""

from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten
import numpy as np
(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()
x_train = x_train[:,:,:,np.newaxis] / 255.0
x_test = x_test[:,:,:,np.newaxis] / 255.0
y_train = to_categorical(y_train)
y_test = to_categorical(y_test)

"""–û–ø–∏—à–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ç–∏ 4:"""

model4 = Sequential()
model4.add(Conv2D(filters=64, kernel_size=2, padding='same',
activation='relu', input_shape=(28,28, 1)))
model4.add(MaxPooling2D(pool_size=2))
model4.add(Flatten())
model4.add(Dense(10, activation='softmax'))
model4.compile(loss='categorical_crossentropy', optimizer='adam',
metrics=['accuracy'])
model4.fit(x_train, y_train, epochs=10, validation_split=0.1)

test_acc = model4.evaluate(x_test, y_test)
print(test_acc)

"""–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏ —á–µ—Ç–≤—ë—Ä—Ç–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞—é—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è:

Loss (—Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å): 0.28379207849502563
Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å): 0.8995 –∏–ª–∏ 89.95%
–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–¢–æ—á–Ω–æ—Å—Ç—å (Accuracy)
–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 89.95%. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–∫–æ–ª–æ 90% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ. –¢–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —Ç–æ—á–Ω–æ—Å—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è –≤—ã—Å–æ–∫–∏–º –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–¥–µ–∂–¥—ã —Å 10 –∫–ª–∞—Å—Å–∞–º–∏.

**–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Loss)**
–ó–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–≤–Ω–æ –ø—Ä–∏–º–µ—Ä–Ω–æ 0.284. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∏–∂–µ, —á–µ–º —É –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –º–æ–¥–µ–ª–µ–π, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–º. –ú–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –±–æ–ª–µ–µ –±–ª–∏–∑–∫–∏ –∫ –∏—Å—Ç–∏–Ω–Ω—ã–º –º–µ—Ç–∫–∞–º –∫–ª–∞—Å—Å–æ–≤.

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏**
–ß–µ—Ç–≤—ë—Ä—Ç–∞—è –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –∫–∞–∫ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∏ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤—ë—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (CNN) –ø–æ–∑–≤–æ–ª–∏–ª–æ –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

---


# **–ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —á–µ—Ç—ã—Ä–µ—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä. –ö–∞–∫–∞—è –∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø–æ—á–µ–º—É? –ö–∞–∫ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∂–¥–æ–π –∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä?**

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —á–µ—Ç—ã—Ä—ë—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä


1.   –ú–æ–¥–µ–ª—å 1 –¢–æ—á–Ω–æ—Å—Ç—å: 84.83% –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: 0.4316 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ø—Ä–æ—Å—Ç–∞—è –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å —Å –æ–¥–Ω–∏–º —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º –∏–∑ 10 –Ω–µ–π—Ä–æ–Ω–æ–≤.
2.   –ú–æ–¥–µ–ª—å 2 –¢–æ—á–Ω–æ—Å—Ç—å: 87.15% –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: 0.3636 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å —Å –æ–¥–Ω–∏–º —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º –∏–∑ 50 –Ω–µ–π—Ä–æ–Ω–æ–≤.
3.   –ú–æ–¥–µ–ª—å 3 –¢–æ—á–Ω–æ—Å—Ç—å: 87.49% –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: 0.3670 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å —Å –¥–≤—É–º—è —Å–∫—Ä—ã—Ç—ã–º–∏ —Å–ª–æ—è–º–∏ –ø–æ 50 –Ω–µ–π—Ä–æ–Ω–æ–≤ –∫–∞–∂–¥—ã–π.
4.   –ú–æ–¥–µ–ª—å 4 –¢–æ—á–Ω–æ—Å—Ç—å: 89.95% –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: 0.2838 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: —Å–≤—ë—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (CNN) —Å –æ–¥–Ω–∏–º —Å–≤—ë—Ä—Ç–æ—á–Ω—ã–º —Å–ª–æ–µ–º –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–º —Å–ª–æ–µ–º.

***–ê–Ω–∞–ª–∏–∑ –∏ –≤—ã–≤–æ–¥—ã***
*–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ú–æ–¥–µ–ª—å 4*. –≠—Ç–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–≤—ë—Ä—Ç–æ—á–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Å–ø–æ—Å–æ–±–Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.

***–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏***


1.   –ú–æ–¥–µ–ª—å 1
–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–µ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∫ –æ–±—É—á–µ–Ω–∏—é.
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ—ë–≤: –≤–≤–µ–¥–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ—ë–≤ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö.
2.   –ú–æ–¥–µ–ª—å 2
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ—ë–≤: –≤–≤–µ–¥–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ—ë–≤ –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ Dropout, –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.
3.   –ú–æ–¥–µ–ª—å 3
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ Dropout –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç–æ–¥–æ–≤ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.
4.   –ú–æ–¥–µ–ª—å 4
–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤—ë—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—ë–≤: –≤–≤–µ–¥–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–≤—ë—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—ë–≤ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ –¥–∞–Ω–Ω—ã—Ö.
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä, —Ç–∞–∫–∏—Ö –∫–∞–∫ ResNet –∏–ª–∏ VGG, –º–æ–∂–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

# –í–∞—Ä–∏–∞–Ω—Ç 9


1.   –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ 2-4-2
2.   –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è 0.35
3.   –í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—ÄX={0.1 -0.1}
4.   –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤–µ—Å–æ–≤ –≤–∑—è—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∏–∑ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ [-0.3 0.3]
5.   Y= {0.5; -0.5}
"""

import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Conv2D, MaxPooling2D, Flatten, Dropout
from tensorflow.keras.datasets import fashion_mnist
from tensorflow.keras.utils import to_categorical
import matplotlib.pyplot as plt

# --- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö ---
(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()
num_classes = 10

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ (–¥–ª—è CNN)
x_train = x_train.reshape(-1, 28, 28, 1).astype('float32') / 255.0
x_test = x_test.reshape(-1, 28, 28, 1).astype('float32') / 255.0

# One-hot –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–∫
y_train = to_categorical(y_train, num_classes)
y_test = to_categorical(y_test, num_classes)

print('–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å x_train:', x_train.shape)
print(x_train.shape[0], '–†–∞–∑–º–µ—Ä train')
print(x_test.shape[0], '–†–∞–∑–º–µ—Ä test')

# --- –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã ---
batch_size = 128
epochs = 10
learning_rate = 0.35  # –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è Adam

# --- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (CNN) ---
model = Sequential([
    Conv2D(32, kernel_size=(3, 3), activation='relu', input_shape=(28, 28, 1)),
    MaxPooling2D(pool_size=(2, 2)),
    Dropout(0.25),

    Conv2D(64, kernel_size=(3, 3), activation='relu'),
    MaxPooling2D(pool_size=(2, 2)),
    Dropout(0.25),

    Flatten(),
    Dense(128, activation='relu', kernel_initializer=RandomUniform(minval=-0.3, maxval=0.3)),
    Dropout(0.5),
    Dense(num_classes, activation='softmax',  kernel_initializer=RandomUniform(minval=-0.3, maxval=0.3))
])

# --- –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–∏ ---
optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)
model.compile(loss='categorical_crossentropy', optimizer=optimizer, metrics=['accuracy'])

model.summary()

# --- –û–±—É—á–µ–Ω–∏–µ ---
hist = model.fit(
    x_train, y_train,
    batch_size=batch_size,
    epochs=epochs,
    verbose=1,
    validation_split=0.1  # 10% –æ—Ç –æ–±—É—á–∞—é—â–∏—Ö ‚Äî –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é
)

print("‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±—É—á–µ–Ω–∞")

# --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ ---
model.save('mnist_cnn_optimized.h5')
print("üíæ –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ mnist_cnn_optimized.h5")

# --- –û—Ü–µ–Ω–∫–∞ ---
score = model.evaluate(x_test, y_test, verbose=0)
print(f'üìâ –ü–æ—Ç–µ—Ä–∏ –Ω–∞ —Ç–µ—Å—Ç–µ: {score[0]:.4f}')
print(f'‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–µ: {score[1]*100:.2f}%')

# --- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ—Ç–µ—Ä—å ---
plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
plt.plot(hist.history['loss'], label='Train Loss')
plt.plot(hist.history['val_loss'], label='Validation Loss')
plt.title('–ü–æ—Ç–µ—Ä–∏ –ø–æ —ç–ø–æ—Ö–∞–º')
plt.xlabel('–≠–ø–æ—Ö–∞')
plt.ylabel('Loss')
plt.legend()
plt.grid(True)

# --- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ ---
plt.subplot(1, 2, 2)
plt.plot(hist.history['accuracy'], label='Train Accuracy')
plt.plot(hist.history['val_accuracy'], label='Validation Accuracy')
plt.title('–¢–æ—á–Ω–æ—Å—Ç—å –ø–æ —ç–ø–æ—Ö–∞–º')
plt.xlabel('–≠–ø–æ—Ö–∞')
plt.ylabel('Accuracy')
plt.legend()
plt.grid(True)

plt.tight_layout()
plt.show()

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.initializers import RandomUniform
from tensorflow.keras.optimizers import SGD
import numpy as np

# --- –£—Å–ª–æ–≤–∏—è –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–∞ 9 ---
X = np.array([[0.1, -0.1]])  # –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä
Y = np.array([[0.5, -0.5]])  # —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –≤—ã—Ö–æ–¥
learning_rate = 0.35
epochs = 100

# --- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ 2-4-2 ---
mlp_model = Sequential()
mlp_model.add(Dense(4, input_dim=2, activation='sigmoid',
                    kernel_initializer=RandomUniform(minval=-0.3, maxval=0.3)))
mlp_model.add(Dense(2, activation='sigmoid',
                    kernel_initializer=RandomUniform(minval=-0.3, maxval=0.3)))

# --- –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ ---
optimizer = SGD(learning_rate=learning_rate)
mlp_model.compile(optimizer=optimizer, loss='mse')

losses = []
accuracies = []

for epoch in range(epochs):
    mlp_model.fit(X, Y, epochs=1, verbose=0)
    pred = mlp_model.predict(X, verbose=0)
    loss = np.mean((Y - pred)**2)
    acc = 1 - np.mean(np.abs(Y - pred)) / np.mean(np.abs(Y))  # –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
    losses.append(loss)
    accuracies.append(acc)

print("\n–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Ññ9 (MLP 2-4-2):")
print(f"–¶–µ–ª–µ–≤–æ–π –≤—ã—Ö–æ–¥: {Y}")
print(f"–í—ã—Ö–æ–¥ —Å–µ—Ç–∏ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è: {pred.round(4)}")

# --- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ç–µ—Ä—å –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ ---
plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
plt.plot(losses, marker='o', color='red')
plt.title("MLP 2-4-2: –û—à–∏–±–∫–∞ –ø–æ —ç–ø–æ—Ö–∞–º (MSE)")
plt.xlabel("–≠–ø–æ—Ö–∞")
plt.ylabel("–û—à–∏–±–∫–∞")
plt.grid(True)

plt.subplot(1, 2, 2)
plt.plot(accuracies, marker='o', color='green')
plt.title("MLP 2-4-2: –ü—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ —ç–ø–æ—Ö–∞–º")
plt.xlabel("–≠–ø–æ—Ö–∞")
plt.ylabel("–¢–æ—á–Ω–æ—Å—Ç—å")
plt.grid(True)

plt.tight_layout()
plt.show()